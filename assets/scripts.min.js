const currentPage={folder:null,bookPath:null,hasOtp:!1,src:null};let updateOtp=!1;const github="https://github.com/reach-sh/reach-developer-portal/blob/master",pathnameToId=e=>e.replace(/^\/|\/$/g,"").replace(/\//g,"_"),idToPathName=e=>e.replace(/_/g,"/");let lang=window.navigator.language.split("-")[0];const homepage=`/${lang}/pages/homepage/`,otpPreferences={none:"none",show:"show",hide:"hide"};Object.freeze(otpPreferences);let otpPreference=otpPreferences.none;const getWinWidthStr=()=>{var e=window.innerWidth;return 1200<=e?"xl":992<=e?"lg":768<=e?"md":576<=e?"sm":"xs"},maxColWidth="280px";let winWidth=getWinWidthStr();const establishDisplay=()=>{if(currentPage.bookPath){const e=document.getElementById("book-col"),t=document.querySelector("div.show-book-col");"xl"==winWidth||"lg"==winWidth||"md"==winWidth?(e.style.maxWidth=maxColWidth,e.style.display="block",t.style.display="none"):"sm"!=winWidth&&"xs"!=winWidth||(e.style.maxWidth="none",e.style.display="none",t.style.display="block")}if(currentPage.hasOtp){const o=document.getElementById("otp-col"),l=document.querySelector("button.show-otp-col");"xl"==winWidth||"lg"==winWidth?(o.style.maxWidth=maxColWidth,otpPreference==otpPreferences.hide?(o.style.display="none",l.style.display="block"):(o.style.display="block",l.style.display="none")):"md"==winWidth?(o.style.maxWidth=maxColWidth,otpPreference==otpPreferences.show?(o.style.display="block",l.style.display="none"):(o.style.display="none",l.style.display="block")):"sm"!=winWidth&&"xs"!=winWidth||(o.style.maxWidth="none",o.style.display="none",l.style.display="block")}};window.addEventListener("resize",()=>{var e=getWinWidthStr();winWidth!=e&&(winWidth=e,establishDisplay())});const getWebpage=async(t,o,l)=>{t="/"==t||t==`/${lang}/`?homepage:t;var n=`${window.location.origin}${t}`,a=`${n}config.json`,c=`${n}page.html`,r=`${n}otp.html`,n=pathnameToId(t);try{var i,d=(await axios.get(a)).data,s=(await axios.get(c)).data,h=(await axios.get(r)).data;if(d.bookPath&&d.bookPath!=currentPage.bookPath&&(document.getElementById("about-this-book").innerHTML=d.bookTitle,i=document.createRange().createContextualFragment((await axios.get(`${window.location.origin}/${d.bookPath}/book.html`)).data),document.querySelectorAll("#book-col div.dynamic").forEach(e=>e.remove()),document.querySelector("#book-col").append(i),document.querySelectorAll("#book-col i.chapter-icon").forEach(e=>{e.addEventListener("click",e=>{const t=e.target;let o=t.closest("div.chapter").querySelector("div.pages");t.classList.contains("fa-angle-right")?(t.classList.remove("fa-angle-right"),t.classList.add("fa-angle-down"),o.style.display="block"):(t.classList.remove("fa-angle-down"),t.classList.add("fa-angle-right"),o.style.display="none")})}),document.querySelectorAll("#book-col div.chapter-title, #book-col div.page-title").forEach(e=>{e.addEventListener("click",e=>{followLink(`/${idToPathName(e.target.id)}/`)})})),currentPage.bookPath=d.bookPath,document.querySelector("div.hh-viewer-wrapper span.title").textContent=d.title,currentPage.src=`${github}${t}index.md`,d.hasEditBtn?document.querySelector("div.hh-page-header button.edit-btn").style.display="block":document.querySelector("div.hh-page-header button.edit-btn").style.display="none",d.hasRefreshBtn?document.querySelector("div.hh-page-header button.refresh").style.display="block":document.querySelector("div.hh-page-header button.refresh").style.display="none",d.author?document.querySelector("div.hh-viewer-wrapper span.author").innerHTML=`By ${d.author}`:document.querySelector("div.hh-viewer-wrapper span.author").innerHTML="",d.publishedDate){let e=new Date(d.publishedDate);document.querySelector("div.hh-viewer-wrapper span.author").innerHTML?document.querySelector("div.hh-viewer-wrapper span.published-date").innerHTML=`on ${e.toLocaleDateString()}`:document.querySelector("div.hh-viewer-wrapper span.published-date").innerHTML=`Published on ${e.toLocaleDateString()}`}else document.querySelector("div.hh-viewer-wrapper span.published-date").innerHTML="";if(s=document.createRange().createContextualFragment(s),document.querySelector("div.hh-viewer-wrapper div.hh-viewer").textContent="",document.querySelector("div.hh-viewer-wrapper div.hh-viewer").append(s),d.hasPageScrollbar?document.getElementById("page-col").classList.remove("noscroll"):document.getElementById("page-col").classList.add("noscroll"),document.querySelectorAll("div.hh-viewer-wrapper div.hh-viewer a").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),followLink(e.target.closest("a").href)})}),d.hasOtp){document.querySelectorAll("#otp-col ul ul.dynamic").forEach(e=>{e.remove()}),document.querySelectorAll("#otp-col ul li.dynamic").forEach(e=>{e.remove()});const u=document.querySelector("#otp-col ul"),p=document.createRange().createContextualFragment(h);p.querySelector("ul").querySelectorAll(":scope > li").forEach((e,t)=>{0==t?(t=e.querySelector("ul"))&&u.querySelector("li").append(t):u.append(e)})}currentPage.hasOtp=d.hasOtp,document.querySelectorAll("#otp-col li.dynamic a").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),followLink(e.target.href)})}),d.menuItem?document.getElementById(d.menuItem).classList.contains("active")||(document.querySelectorAll("header a").forEach(e=>{e.classList.remove("active")}),document.getElementById(d.menuItem).classList.add("active")):document.querySelectorAll("header a").forEach(e=>{e.classList.remove("active")}),document.querySelectorAll("#book-col div.chapter-title, #book-col div.page-title").forEach(e=>{e.classList.remove("active")});let e=document.getElementById(n);if(e){e.classList.add("active");let t=e.closest("div.chapter"),o=t.querySelector("div.pages");if(o.hasChildNodes()){let e=t.querySelector("i.chapter-icon");e.classList.remove("fa-angle-right"),e.classList.add("fa-angle-down"),o.style.display="block"}}establishDisplay(),d.bookPath?(document.getElementById("book-col").classList.remove("banish"),document.querySelector("div.show-book-col").classList.remove("banish")):(document.getElementById("book-col").classList.add("banish"),document.querySelector("div.show-book-col").classList.add("banish")),d.hasPageHeader?document.querySelector("div.hh-page-header").style.display="block":document.querySelector("div.hh-page-header").style.display="none",document.getElementById("page-col").style.display="block",d.hasOtp?(document.getElementById("otp-col").classList.remove("banish"),document.querySelector("button.show-otp-col").classList.remove("banish")):(document.getElementById("otp-col").classList.add("banish"),document.querySelector("button.show-otp-col").classList.add("banish")),currentPage.folder=t,o&&"#on-this-page"!==o?(document.getElementById(o.substring(1)).scrollIntoView(),l&&window.history.pushState(null,null,`${window.location.origin}${t}${o}`)):(document.getElementById("page-col").scrollTo(0,0),l&&window.history.pushState("{}","",`${window.location.origin}${t}`))}catch(e){console.log(e)}},followLink=async e=>{let t=document.createElement("a");t.href=e,console.log(t.pathname),console.log(t.hash),t.hostname===window.location.hostname?currentPage.folder==t.pathname&&t.hash?"#on-this-page"===t.hash?(history.pushState(null,null,currentPage.folder),document.getElementById("page-col").scrollTo(0,0)):(history.pushState(null,null,t.hash),document.getElementById(t.hash.substring(1)).scrollIntoView()):await getWebpage(t.pathname,t.hash,!0):window.open(t.href,"_blank").focus()};window.onpopstate=function(e){let t=document.createElement("a");t.href=document.location.href,getWebpage(t.pathname,null,!1)},document.querySelector("button.hide-book-icon").addEventListener("click",e=>{"sm"!=winWidth&&"xs"!=winWidth||(document.getElementById("page-col").style.display="block"),document.getElementById("book-col").style.display="none",document.querySelector("div.show-book-col").style.display="block"}),document.querySelector("button.show-book-col").addEventListener("click",e=>{"sm"!=winWidth&&"xs"!=winWidth||(document.getElementById("page-col").style.display="none"),document.getElementById("book-col").style.display="block",document.querySelector("div.show-book-col").style.display="none"}),document.querySelector("button.hide-otp-icon").addEventListener("click",e=>{"sm"!=winWidth&&"xs"!=winWidth||(document.getElementById("page-col").style.display="block"),document.getElementById("otp-col").style.display="none",document.querySelector("button.show-otp-col").style.display="block",otpPreference=otpPreferences.hide}),document.querySelector("button.show-otp-col").addEventListener("click",e=>{"sm"!=winWidth&&"xs"!=winWidth||(document.getElementById("page-col").style.display="none"),document.getElementById("otp-col").style.display="block",document.querySelector("button.show-otp-col").style.display="none",otpPreference=otpPreferences.show}),document.querySelectorAll("header a.navbar-brand").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),followLink(e.currentTarget.href)})}),document.querySelectorAll("header a.follow").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),followLink(e.currentTarget.href)})}),document.querySelector("#otp-col a[href='#on-this-page']").addEventListener("click",e=>{e.preventDefault(),followLink("#on-this-page")}),document.querySelector("div.hh-viewer-wrapper button.edit-btn").addEventListener("click",e=>{e.preventDefault(),followLink(currentPage.src)}),document.querySelector("div.hh-page-header button.refresh").addEventListener("click",e=>{e.preventDefault(),getWebpage(window.location.pathname,null,!1)}),document.getElementById("about-this-book").addEventListener("click",e=>{e.preventDefault(),getWebpage(`/${currentPage.bookPath}/`,null,!0)}),document.getElementById("page-col").addEventListener("scroll",function(e){if(document.querySelectorAll("#otp-col li.dynamic").length)if(0==updateOtp)updateOtp=!0;else{let o=!1,l=document.querySelectorAll("#page-col div.hh-viewer h1, #page-col div.hh-viewer h2");if(l.length){for(let t=l.length-1;0<=t;t--)if(l[t].getBoundingClientRect().y<=80){o=!0;let e=document.querySelector('#otp-col ul li a[href="#'+l[t].id+'"]');e.classList.contains("active")||(document.querySelector("#otp-col a.active").classList.remove("active"),e.classList.add("active"),window.history.pushState(null,null,`${window.location.origin}${currentPage.folder}#${l[t].id}`));break}0==o&&(document.querySelector("#otp-col a[href='#on-this-page']").classList.contains("active")||(document.querySelector("#otp-col a.active").classList.remove("active"),document.querySelector("#otp-col a[href='#on-this-page']").classList.add("active")))}}else e.target.onscroll=null}),getWebpage(window.location.pathname,window.location.hash,!0);